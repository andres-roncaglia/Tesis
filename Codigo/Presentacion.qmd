---
format: 
    revealjs:
        width: 1050
        height: 700
        margin: 0.01
        self-contained: True 
        theme: [default, presentations_theme.scss]
        slide-number: true
        embed-resources: true
        auto-stretch: false
        fig-align: center
        callout-appearance: simple        
---

```{python}

def funcion_zoom(img_path, zoom_name, img_size=70, zoom=100, position_top="unset", position_left="unset", extra=""):
  img_width = 1050*(img_size/100)
  img_height = img_width/(15.85/10.15)
  
  code_block = "```"

  img_w_zoom = f"""
  <style>
  .{zoom_name} {{
    overflow: hidden !important;
    width: {img_width}px;
    height: {img_height}px;
    margin: 0 auto;
    background: white;
  }}
  
  {extra}

  .{zoom_name} p {{margin:0 auto; height: {img_height}px}}
  </style>

:::{{.{zoom_name} .img_style}}
  ![]({img_path}){{data-id='{zoom_name}' style='position: relative; top: {position_top}; left:{position_left}; width: {zoom}%; height: {zoom}%; max-width: none !important; max-height: none !important;  margin: 0 auto;'}}
:::
  
  """

  print(img_w_zoom)

```


## 

<script>
document.addEventListener("mousedown", function(e) {
  // Left click
  if (e.button === 0) {
    Reveal.next();
  }
  // Right click
  if (e.button === 2) {
    e.preventDefault();
    Reveal.prev();
  }
});
document.addEventListener("contextmenu", e => e.preventDefault());
</script>

![](../Imgs/Portada_presentacion.png){fig-align="center" width="100%"}

## Resumen {.theme-slideSimple}

::: {.fragment .fade-in-then-semi-out}
1. Presentaci√≥n del contexto y objetivos
:::

::: {.fragment .fade-in-then-semi-out}
2. Metodolog√≠a de los modelos
:::

::: {.fragment .fade-in-then-semi-out}
3. Evaluaci√≥n, validaci√≥n e intervalos de predicci√≥n de los modelos
:::

::: {.fragment .fade-in-then-semi-out}
4. Aplicaci√≥n
:::

::: {.fragment .fade-in-then-semi-out}
5. Comparaci√≥n de resultados
:::

::: {.fragment .fade-in}
6. Conclusi√≥n
:::


# 1. Motivaci√≥n y objetivos {.center .theme-slideTitle}

## 1. Motivaci√≥n {.theme-slideBoxLeft style="font-size:1.1em !important;"}

:::{.nofragment}

- El pron√≥stico de series de tiempo es clave en m√∫ltiples √°mbitos

- Crecimiento exponencial en la cantidad de datos disponibles

- Los m√©todos actuales de pron√≥stico requieren amplios conocimientos, son dif√≠ciles de automatizar y/o son demandantes computacionalmente

:::

## 1. Motivaci√≥n {.theme-slideBoxRightPic}

### Modelos fundacionales preentrenados

- Capaces de seleccionar de forma autom√°tica el mejor ajuste

- No requieren entrenamiento previo ni conocimientos especializados 

- Basados en arquitecturas *transformer*

::: {.fragment}
::: {.callout-tip title=""}

¬øQu√© tan bien se desempe√±an?

:::

:::

![](../Imgs/modelo_timegpt.png){.img_style}

## 1. Objetivos {.theme-slideBoxLeft}

::: {.nofragment}
- Comparar la precisi√≥n, eficiencia y facilidad de pronosticar series de tiempo con:

    - Modelos estad√≠sticos tradicionales

    - Modelos de aprendizaje automatizado

    - Modelos de aprendizaje profundo

    - Modelos fundacionales preentrenados
:::

::: {.fragment .fade-in}
- Definir y aplicar m√©tricas de evaluaci√≥n

    - MAPE

    - *Interval score*
:::

::: {.fragment .fade-in}
- Reflexionar sobre los criterios de selecci√≥n de modelos
:::

# 2.1 Modelos estad√≠sticos tradicionales {.center .theme-slideTitle}

## 2.1 Modelos estad√≠sticos tradicionales {.theme-slideBoxLeft}

Modelo $SARIMA(p,d,q)(P,D,Q)_s$

:::{.mathsmall}
$$
\underbrace{\psi_p(B)(1-B)^d}_{\text{Parte regular}} \ \underbrace{\Psi_P(B^s)(1-B^s)^D}_\text{Parte estacional} z_t = \theta_0 + \underbrace{\theta_q(B)}_\text{P. r.} \ \underbrace{\Theta_Q(B^s)}_\text{P. e.}\alpha_t
$$

:::

Propiedades de un buen modelo $SARIMA$:

- Los residuos del modelo se comportan como ruido blanco

    - Incorrelacionados

    - Distribu√≠dos aproximadamente de forma normal

    - Variancia y media constantes

::: {.fragment}
- Es admisible
:::

::: {.fragment}
- Es parsimonioso
:::

# 2.2 Modelos de aprendizaje autom√°tico {.center .theme-slideTitle}

## Descenso del gradiente{.theme-slideBoxRightPic}

::: {.callout-note title="Descenso del gradiente"}
Algoritmo iterativo para optimizar los par√°metros de un modelo.

$$
\theta_1 = \theta_0 - \eta \cdot \nabla L(\theta_0)
$$
:::

Calcula en cada paso la derivada de la funci√≥n de costo con respecto a cada par√°metro en su valor actual

Se actualizan los valores de los par√°metros desplazandolos una peque√±a magnitud $\eta$ (tasa de aprendizaje)

![](../Imgs/desc_gradiente.png){.img_style}


## 2.2 Modelos de aprendizaje autom√°tico {.theme-slideSimple}

::: {.callout-note title="Aprendizaje autom√°tico (*machine learning*)"}
Rama de la inteligencia artificial que permite a las computadoras aprender de los datos y realizar tareas de forma aut√≥noma.
:::

::: {.fragment .centro}

**√Årbol de decisi√≥n**

![](../Imgs/arbol_decision.png){fig-align="center" .img_style width="60%"}
:::

## 2.2 Modelos de aprendizaje autom√°tico {.theme-slideSimple auto-animate="true"}

::: {.callout-tip title="M√©todos de ensamble"}
Buscan mejorar la robustez y precisi√≥n de las predicciones combinando los resultados de varios estimadores base.
:::

::: {.callout-note title="*Boosting*"}
Construcci√≥n de predictores base de forma secuencial donde cada nuevo predictor busca predecir los residuos del anterior.
:::

## 2.2 Modelos de aprendizaje autom√°tico {.theme-slideSimple auto-animate="true"}

::: {.callout-note title="*Boosting*"}
Construcci√≥n de predictores base de forma secuencial donde cada nuevo predictor busca predecir los residuos del anterior.
:::

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/Ensamblaje.png", zoom_name = "ensemble", img_size=65)
```


## 2.2 Modelos de aprendizaje autom√°tico {.theme-slideSimple auto-animate="true"}

::: {.callout-note title="*Boosting*"}
Construcci√≥n de predictores base de forma secuencial donde cada nuevo predictor busca predecir los residuos del anterior.
:::

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/Ensamblaje.png", zoom_name = "ensemble", img_size=65, zoom=205, position_top="50px", position_left="-255px")
```

## 2.2 Modelos de aprendizaje autom√°tico {.theme-slideSimple auto-animate="true"}

::: {.callout-note title="*Boosting*"}
Construcci√≥n de predictores base de forma secuencial donde cada nuevo predictor busca predecir los residuos del anterior.
:::

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/Ensamblaje.png", zoom_name = "ensemble", img_size=65, zoom=205, position_top="50px", position_left="-790px")
```

## 2.2 Modelos de aprendizaje autom√°tico {.theme-slideSimple auto-animate="true"}

::: {.callout-note title="*Boosting*"}
Construcci√≥n de predictores base de forma secuencial donde cada nuevo predictor busca predecir los residuos del anterior.
:::

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/Ensamblaje.png", zoom_name = "ensemble", img_size=65, zoom=205, position_top="-250px", position_left="-505px")
```

## 2.2 Modelos de aprendizaje autom√°tico {.theme-slideSimple auto-animate="true"}

::: {.callout-note title="*Boosting*"}
Construcci√≥n de predictores base de forma secuencial donde cada nuevo predictor busca predecir los residuos del anterior.
:::

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/Ensamblaje.png", zoom_name = "ensemble", img_size=65, zoom=205, position_top="-250px", position_left="0px")
```

## 2.2 Modelos de aprendizaje autom√°tico {.theme-slideSimple auto-animate="true"}

::: {.callout-note title="*Boosting*"}
Construcci√≥n de predictores base de forma secuencial donde cada nuevo predictor busca predecir los residuos del anterior.
:::

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/Ensamblaje.png", zoom_name = "ensemble", img_size=65, zoom=200, position_top="-555px", position_left="-600px")
```

## 2.2 Modelos de aprendizaje autom√°tico {.theme-slideBorders .center}

:::{.body}

Diferencias entre *eXtreme Gradient Boosting* (XGBoost) y *Light Gradient-Boosting Machine* (LightGBM)

|                                                | XGBoost   | LightGBM  |
|------------------------------------------------|-----------|-----------|
| M√©todo de partici√≥n                            | Exacto    | GOSS      |
| Crecimiento del √°rbol                          | Por nivel | Por hojas |
| Tratamiento de caracter√≠sticas correlacionadas | Ninguno   | EFB       |

:::

# 2.3 Modelos de aprendizaje profundo {.center .theme-slideTitle}

## 2.3 Modelos de aprendizaje profundo {.theme-slideSimple auto-animate="true"}

::: {.callout-tip title="Aprendizaje profundo (*deep learning*)"}
Conjunto de algoritmos que modelan niveles altos de abstracci√≥n usando m√∫ltiples capas de procesamiento, con complejas estructuras o compuestas de varias transformaciones no lineales.
:::

::: {.callout-note title="Red neuronal"}
Busca imitar el funcionamiento del cerebro humano. Compuesta por neuronas y conexiones (pesos).
:::

## 2.3 Modelos de aprendizaje profundo {.theme-slideSimple auto-animate="true"}

::: {.callout-note title="Red neuronal"}
Busca imitar el funcionamiento del cerebro humano. Compuesta por neuronas y conexiones (pesos).
:::

![](../Imgs/conexiones_redneuro.png){fig-align="center" .img_style width="65%"}

## 2.3 Modelos de aprendizaje profundo{.theme-slideBorders .center}

::::{.body}

:::{.centro}
**Retropropagaci√≥n**
:::

![](../Imgs/retropropagacion.gif){.img_style fig-align="center"}

::::

## 2.3 Modelos de aprendizaje profundo{.theme-slideBoxRightPic}

**Tipos de redes neuronales**

- *Feedforward Neural Networks* (FNN)

- *Convolutional Neural Networks* (CNN)

- *Recurrent Neural Networks* (RNN)

- Entre otras...

![](../Imgs/red_recurrente.png){.img_style}


## 2.3 Modelos de aprendizaje profundo{.theme-slideSimple}

::: {.callout-important title="Limitaciones de las RNNs"}
Tienen dificultades para capturar dependencias de largo plazo. Causas: Desvanecimiento o explosi√≥n del gradiente.
:::

![](../Imgs/retropropagacion_rnn.png){.img_style fig-align="center" width="65%"}


## 2.3 Modelos de aprendizaje profundo {auto-animate="true" .theme-slideSimple}

::: {.callout-tip title="Redes *Long-Short Term Memory* (LSTM)"}
Tipo de RNN que almacena informaci√≥n a corto y largo plazo mediante un sistema log√≠stico de 3 'puertas'.
:::

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/lstm.png", zoom_name = "zoom", img_size=70)
```

## 2.3 Modelos de aprendizaje profundo {auto-animate="true" .theme-slideSimple}

::: {.callout-note title="Puerta de guardado"}
Se encarga de decidir que proporci√≥n de la informaci√≥n a largo plazo mantener en la neurona de memoria en cada iteraci√≥n.
:::

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/lstm.png", zoom_name = "zoom", img_size=70, zoom=140, position_top="-186px", position_left="140px")
```

## 2.3 Modelos de aprendizaje profundo {auto-animate="true" .theme-slideSimple}

::: {.callout-note title="Puerta de entrada"}
Controla que informaci√≥n a√±adir a la neurona de memoria. Propone un nuevo valor para la informaci√≥n a largo plazo y decide que proporci√≥n sumar al valor actual.
:::

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/lstm.png", zoom_name = "zoom", img_size=70, zoom=140, position_top="-186px", position_left="-140px")
```


## 2.3 Modelos de aprendizaje profundo {auto-animate="true" .theme-slideSimple}

::: {.callout-note title="Puerta de salida"}
Se encarga de extraer la informaci√≥n m√°s importante del estado actual de la neurona para usar como salida o valor para la pr√≥xima iteraci√≥n de la red.
:::

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/lstm.png", zoom_name = "zoom", img_size=70, zoom=140, position_top="-186px", position_left="-395px")
```

# 2.4 Modelos fundacionales preentrenados {.center .theme-slideTitle}

## 2.4 Modelos fundacionales preentrenados {.theme-slideBoxLeft}

::: {.callout-tip title="‚Äé " appearance="default" icon="false"}

**Fundacional**: Entrenado en grandes conjuntos de datos

**Preentrenado**: Los par√°metros del modelo fueron previamente calculados

:::

Generalmente basados en arquitecturas *transformer*

- ChatGPT

- BERT

- Claude

:::{.fragment}

Para pronosticar series de tiempo:

- TimeGPT

- Chronos

:::


## 2.4 Modelos fundacionales preentrenados {.theme-slideSimple}

::: {.callout-note title="Atenci√≥n"}

Mecanismo que captura dependencias y relaciones en la secuencias de valores que se alimentan al modelo, logrando poner en contexto a cada observaci√≥n. Presentado en la publicaci√≥n *Attention is all you need* de Google en 2017.

:::{.fragment}

$$
\text{Atencion}(Q,K,V) = softmax(\frac{QK^T}{\sqrt{d_k}})V
$$

:::
:::

:::{.fragment}

$\vec E$: Vector de entrada

$W_Q$: Matriz de caracter√≠sticas ($\vec E \times W_Q = \vec Q$)

$W_K$: Matriz de relaciones ($\vec E \times W_K = \vec K$)

$W_V$: Matriz de valores ($\vec E \times W_V = \vec V$)

Matrices iniciadas aleatoriamente y ajustadas en el preentrenado
:::


## 2.4 Modelos fundacionales preentrenados {.theme-slideBorders .center}

:::{.body}

![](../Imgs/gif_attention1.gif){fig-align="center"}

:::

## 2.4 Modelos fundacionales preentrenados {.theme-slideBorders .center}

:::{.body}

![](../Imgs/gif_attention2.gif){fig-align="center"}

:::

## 2.4 Modelos fundacionales preentrenados {.theme-slideBorders .center}

:::{.body}

![](../Imgs/gif_attention3.gif){fig-align="center"}

:::

## 2.4 Modelos fundacionales preentrenados {.theme-slideBorders .center}

:::{.body}

![](../Imgs/gif_attention4.gif){fig-align="center"}

:::

## 2.4 Modelos fundacionales preentrenados {.theme-slideBorders .center}

:::{.body}

![](../Imgs/gif_attention5.gif){fig-align="center"}

:::

## 2.4 Modelos fundacionales preentrenados {.theme-slideBorders .center}

:::{.body}

![](../Imgs/gif_attention6.gif){fig-align="center"}

:::

## 2.4 Modelos fundacionales preentrenados {auto-animate="true" .theme-slideSimple}

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/modelo_timegpt.png", zoom_name = "attention", img_size=65, zoom=100)
```


## 2.4 Modelos fundacionales preentrenados {auto-animate="true" .theme-slideSimple}

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/modelo_timegpt.png", zoom_name = "attention", img_size=65, zoom=180, position_top = "-420px", position_left = '200px')
```


::: {.callout-note title="Representaci√≥n vectorial y codificaci√≥n posicional"}
Se *tokenizan* los datos de entrada y se los representa vectorialmente ($\vec E$). Se suma a $\vec E$ un vector con patrones espec√≠ficos que integran al vector de entrada la informaci√≥n posicional del *token*.
:::


## 2.4 Modelos fundacionales preentrenados {auto-animate="true" .theme-slideSimple}

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/modelo_timegpt.png", zoom_name = "attention", img_size=65, zoom=180, position_top = "-420px", position_left = '-80px')
```

::: {.callout-note title="Suma y normalizado"}
Las conexiones residuales se a√±aden sobre el vector de entrada en la salida de cada capa.

La normalizaci√≥n estabiliza el entrenamiento y mejora la convergencia.
:::

## 2.4 Modelos fundacionales preentrenados {auto-animate="true" .theme-slideSimple}

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/modelo_timegpt.png", zoom_name = "attention", img_size=65, zoom=180, position_top = "-120px", position_left = '-80px')
```

::: {.callout-note title="Red neuronal convolucional (CNN)"}
Utilizada para descubrir patrones en los datos.
:::

## 2.4 Modelos fundacionales preentrenados {auto-animate="true" .theme-slideSimple}

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/modelo_timegpt.png", zoom_name = "attention", img_size=65, zoom=110, position_top = "-50px", position_left = '-240px')
```


## 2.4 Modelos fundacionales preentrenados {auto-animate="true" .theme-slideSimple}

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/modelo_timegpt.png", zoom_name = "attention", img_size=65, zoom=180, position_top = "-400px", position_left = '-740px')
```

::: {.callout-note title="Representaci√≥n vectorial (Decodificador)"}
La entrada del decodificador son los *tokens* desplazados hacia la derecha.
:::

:::{auto-animate-delay="1"}
![](../Imgs/desp_derecha.png){data-id="desplazado" .img_style width="400px !important" height="256.15px" style="position:absolute; top:40px; left:50px; box-shadow:0px 30px 70px 20px #789 !important; z-index: 2;  width: 400px !important;"}
:::

## 2.4 Modelos fundacionales preentrenados {auto-animate="true" .theme-slideSimple}


```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/modelo_timegpt.png", zoom_name = "attention", img_size=65, zoom=180, position_top = "-400px", position_left = '-450px')
```

::: {.callout-note title="Enmascaramiento"}
Antes de la aplicaci√≥n de softmax se reemplazan todos los valores debajo de la diagonal principal de la matriz $QK$ por $-\infty$.
:::


<style>
.bug{z-index:2 !important; position:absolute !important; width:100%; height:100%; top:0;}
.bug p {z-index:2 !important; position:absolute !important; width:100% !important; height:100% !important; line-height:100% !important}
</style>

::: {.bug auto-animate-delay="1"}
![](../Imgs/Enmascaramiento.png){data-id="enmascaramiento" .img_style height="256.15px" style="position:absolute; top:40px; left:0px; box-shadow:0px 30px 70px 20px #789 !important; z-index: 2; width: 400px !important;"}
:::

## 2.4 Modelos fundacionales preentrenados {auto-animate="true" .theme-slideSimple}

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/modelo_timegpt.png", zoom_name = "attention", img_size=65, zoom=160, position_top = "0px", position_left = '-340px')
```

::: {.callout-note title="Atenci√≥n multicabezal"}

Se usan las matrices $K$ y $V$ que da como salida el codificador. $Q$ es la salida de la capa de atenci√≥n multicabezal enmascarada.

:::

## 2.4 Modelos fundacionales preentrenados {auto-animate="true" .theme-slideSimple}

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/modelo_timegpt.png", zoom_name = "attention", img_size=65, zoom=180, position_top = "0px", position_left = '-750px')
```

::: {.callout-note title="Conexi√≥n lineal"}
*Feed Forward Network* completamente conectada que traduce las representaciones de atributos aprendidos en predicciones.
:::


## 2.4 Modelos fundacionales preentrenados {.theme-slideBorders .center}

:::{.body}

:::{.centro}
Diferencias entre TimeGPT y Chronos
:::

:::{.letraTablaChica}
|                                   | TimeGPT    | Chronos   |
|-----------------------------------|-----------------------------------|-----------------------------------|
| Accesibilidad al c√≥digo           | Cerrado    | Abierto   |
| Estructura *transformer*          | Especializado en series de tiempo | Adaptaci√≥n de modelos de lenguaje |
| *Tokenizacion*          | No realiza | Necesaria |
| Softmax en los resultados         | No realiza | Necesaria |
| B√∫squeda de patrones en los datos | CNN        | FNN       |
:::

:::

# 3. Evaluaci√≥n, validaci√≥n e intervalos de predicci√≥n del modelo {.center .theme-slideTitle}

## 3. Evaluaci√≥n {.theme-slideBoxLeft auto-animate="true"}

::: {.callout-note title="M√©tricas de evaluaci√≥n"}
Medidas cuantitativas para medir el ajuste del modelo.
:::

:::{.fragment}
:::{.callout-tip title="Predicciones puntuales" data-id="metrica"}
Porcentaje del error absoluto medio:

$$
MAPE = (\frac{1}{h}\sum^h_{l=1}|\frac{e_l}{z_{n+l}}|)\cdot 100 \%
$$

Donde:

$e_l = z_{n+l} - \hat z_n(l)$: Error de la l-√©sima predicci√≥n

$\hat z_n(l)$: Pron√≥stico de la observaci√≥n $z_{n+l}$

:::
:::

## 3. Evaluaci√≥n {.theme-slideBoxLeft auto-animate="true"}

::: {.callout-note title="M√©tricas de evaluaci√≥n"}
Medidas cuantitativas para medir el ajuste del modelo.
:::


:::{.callout-tip title="Predicciones probabil√≠sticas" data-id="metrica"}
*Interval Score*:

$$
S = \frac{1}{h}\sum_{l=1}^h (W_l + O_l + U_l) 
$$

Donde:

$W_l = IS_l - II_l \hspace{1, cm}$

$IS_l$: L√≠mite superior del intervalo

$II_l$: L√≠mite inferior del intervalo

$O_l = \left \{ \begin{matrix} \frac{2}{\alpha}(z_n(l) - z_{n+l}) \hspace{10,mm} \text{si } z_n(l) > z_{n+l} \\ 0 \hspace{1,cm} \text{en otro caso} \hfill \end{matrix} \right.$

$U_l = \left \{ \begin{matrix} \frac{2}{\alpha}(z_{n+l} - z_n(l)) \hspace{10,mm} \text{si } z_n(l) < z_{n+l} \\ 0 \hspace{1,cm} \text{en otro caso} \hfill \end{matrix} \right.$

:::

## 3. Validaci√≥n {.theme-slideSimple}

:::{.callout-note title="Sobreajuste"}
Los par√°metros del modelo se ajustan en exceso a los datos de entrenamiento, comprometiendo la capacidad del modelo de generalizar frente a datos no observados.
:::

:::{.fragment}
::: {.callout-note title="Validaci√≥n *hold-out*"}
Reservar un una parte del conjunto de entrenamiento como validaci√≥n.

$$
\text{Conjunto de entrenamiento total : } \{\underbrace{z_1, ...,  z_c}_{\text{Entrenamiento}}, \underbrace{z_{c+1}, ..., z_n}_{\text{Validaci√≥n}} \}
$$

:::

Se entrenan los modelos sobre el conjunto de entrenamiento y se prueban las m√©tricas sobre el de validaci√≥n.

::: {.callout-important}

El corte debe hacerse respetando el orden temporal de las observaciones. En caso de haber estacionalidad, ambos conjuntos deben cubrir al menos un ciclo.

:::
:::


## 3. Intervalos de predicci√≥n {.theme-slideSimple}

::: {.callout-warning title="Limitaciones de modelos modernos"}

No realizan supuestos distribucionales, y por lo tanto, no generan pron√≥sticos probabil√≠sticos.

:::

:::{.fragment}

*Ensemble Batch Prediction Intervals* (EnbPI)

1. Generar B muestras *bootstrap* por bloques.

2. Ajustar un modelo sobre cada una de las B muestras.

3. Calcular el residuo de cada observaci√≥n utilizando aquellos modelos que no la incluyeron.

4. Obtener las predicciones puntuales promediando los resultados de los B modelos.

5. Construir los intervalos de predicci√≥n usando los cuantiles emp√≠ricos de los residuos.

:::

# 4. Aplicaci√≥n {.center .theme-slideTitle}

## 4. Aplicaci√≥n: Series analizadas{.theme-slideBorders .center}

:::{.body}

::: {.callout-tip icon="false" appearance="default" title="Serie 1"} 
Atenciones mensuales en guardia por patolog√≠as respiratorias en el Hospital de Ni√±os V√≠ctor J. Vilela de la ciudad de Rosario
:::

::: {.callout-important icon="false" appearance="default" title="Serie 2"} 
Temperaturas por hora en los primeros d√≠as de marzo de 2025 en la ciudad de Rosario
:::

:::

## 4.1 Aplicaci√≥n: SARIMA - Serie 1 {.theme-slideSimple auto-animate="true"}

### Atenciones en guardia

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/Serie1.png", zoom_name = "serie1", img_size=70, zoom=298, position_top = "0px", position_left = '0px')
```

::: {.footer}
Informaci√≥n provista por la Direcci√≥n General de Estad√≠stica de la Municipalidad de Rosario.
:::

## 4.1 Aplicaci√≥n: SARIMA - Serie 1 {.theme-slideSimple auto-animate="true"}

### Atenciones en guardia

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/Serie1.png", zoom_name = "serie1", img_size=70, zoom=290, position_top = "2px", position_left = '-1415px')
```

## 4.1 Aplicaci√≥n: SARIMA - Serie 1 {.theme-slideSimple auto-animate="true"}

### Atenciones en guardia

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/Serie1.png", zoom_name = "serie1", img_size=70, zoom=290, position_top = "-448px", position_left = '-700px')
```

## 4.1 Aplicaci√≥n: SARIMA - Serie 1 {.theme-slideSimple auto-animate="true"}

### Atenciones en guardia

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/Serie1.png", zoom_name = "serie1", img_size=70, zoom=303, position_top = "-1066px", position_left = '-20px')
```


## 4.1 Aplicaci√≥n: SARIMA - Serie 1 {.theme-slideSimple auto-animate="true"}

### Atenciones en guardia

```{python}
#| output: asis

funcion_zoom(img_path = "../Imgs/Serie1.png", zoom_name = "serie1", img_size=70, zoom=308, position_top = "-980px", position_left = '-1520px')
```

## 4.1 Aplicaci√≥n: SARIMA - Serie 1 {.theme-slideSimple auto-animate="true"}

:::{.centro}
**Modelo propuesto:** $SARIMA(0,1,0)(0,1,1)_{12}$
:::

::: {.columns}
::: {.column .alinear width="50%"}
![](../Imgs/plotnine/resid_arima_AT1_1.png){.img_style width="70%" style="margin:0;" data-id="sup1"}
![](../Imgs/plotnine/resid_arima_AT1_3.png){.img_style width="70%" style="margin:0;" data-id="sup2"}
:::
::: {.column .smargen width="50%"}
![](../Imgs/plotnine/resid_arima_AT1_2.png){.img_style width="70%" style="margin:0;" data-id="sup3"}
![](../Imgs/plotnine/resid_arima_AT1_4.png){.img_style width="70%" style="margin:0;" data-id="sup4"}
:::
:::


## 4.1 Aplicaci√≥n: SARIMA - Serie 1 {.theme-slideSimple}

:::{.body}

```{python}
# Para mostrar los resultados
from Funciones import load_env, summary_to_html

globals().update(load_env('../Codigo/Ambiente/metricas_arima.pkl'))
globals().update(load_env('../Codigo/Ambiente/Amb_Aplicacion_chronos.pkl'))

```

:::{.centro}
**Pron√≥stico**
:::

![](../Imgs/plotnine/pronAT1.png){.img_style fig-align="center" width="95%"}

| Modelo                       | Horizonte | MAPE   | *Interval Score* |
|------------------------------|-----------|--------|------------------|
|                              | 3         | `{python} round(mape_AT1_3, 4)`     | `{python} round(is_AT1_3, 4)`        |
| $SARIMA(0,1,0)(0,1,1 )_{12}$ | 6         | `{python} round(mape_AT1_6, 4)`     | `{python} round(is_AT1_6, 4)`        |
|                              | 12        | `{python} round(mape_AT1, 4)` | `{python} round(is_AT1, 4)` |

:::

## 4.1 Aplicaci√≥n: SARIMA - Serie 2 {.theme-slideSimple}

### Temperatura por hora

::: {r.vstack}

![](../Imgs/plotnine/temperatura1.png){width="65%" fig-align="center" data-id="temp1" .img_style}

![](../Imgs/plotnine/temperatura2.png){width="65%" fig-align="center" .img_style}

![](../Imgs/plotnine/temperatura3.png){width="65%" fig-align="center" .img_style}

:::


::: footer
Datos obtenidos a partir de la p√°gina del Servicio Meteorol√≥gico Nacional
:::


## 4.1 Aplicaci√≥n: SARIMA - Serie 2 {.theme-slideSimple}

:::{.centro}
Modelo seleccionado de forma autom√°tica con `autoarima`: $SARIMAX(1,1,1)(2,0,1)_{24}$
:::

```{python}

globals().update(load_env('../Codigo/Ambiente/Amb_Aplicacion.pkl'))
```

:::{.tablaLetraChica}
```{python}
#| output: asis

summary_to_html(resultados_arima['salida_arima_temperatura_auto'])
```
:::

## 4.1 Aplicaci√≥n: SARIMA - Serie 2 {.theme-slideSimple}

:::{.centro}
**Modelo propuesto:** $SARIMAX(1,1,0)(1,0,1)_{24}$
:::

::: {.columns}
::: {.column .alinear width="50%"}
![](../Imgs/plotnine/resid_arima_TE4_1.png){.img_style width="70%" style="margin:0;" data-id="sup1"}
![](../Imgs/plotnine/resid_arima_TE4_3.png){.img_style width="70%" style="margin:0;" data-id="sup2"}
:::
::: {.column .smargen width="50%"}
![](../Imgs/plotnine/resid_arima_TE4_2.png){.img_style width="70%" style="margin:0;" data-id="sup3"}
![](../Imgs/plotnine/resid_arima_TE4_4.png){.img_style width="70%" style="margin:0;" data-id="sup4"}
:::
:::


## 4.1 Aplicaci√≥n: SARIMA - Serie 2 {.theme-slideSimple}

:::{.body}

:::{.centro}
**Pron√≥stico**
:::

![](../Imgs/plotnine/pronTE4.png){.img_style fig-align="center" width="95%"}

| Modelo                       | Horizonte | MAPE   | *Interval Score* |
|------------------------------|-----------|--------|------------------|
|                              | 6         | `{python} round(mape_TE4_6, 4)`     | `{python} round(is_TE4_6, 4)`        |
| $SARIMA(1,1,0)(1,0,1)_{12}$ | 12         | `{python} round(mape_TE4_12, 4)`     | `{python} round(is_TE4_12, 4)`        |
|                              | 24        | `{python} round(mape_TE4, 4)` | `{python} round(is_TE4, 4)` |

:::

## 4.2 Aplicaci√≥n: Modelos de aprendizaje autom√°tico {.theme-slideBoxLeft}

**Caracter√≠sticas elegidas:**

- Identificaci√≥n temporal

- El promedio de las 3 observaciones anteriores 

- El desv√≠o est√°ndar de las 3 observaciones anteriores

- El valor del primer rezago

- El valor del segundo rezago

- El valor del rezago estacional

## 4.2 Aplicaci√≥n: Modelos de aprendizaje autom√°tico {.theme-slideSimple}

\

::: {.centro}
**M√©tricas con XGBoost**
:::

::::{.tablaLetraChica .img_style style="background-color:white; width: auto; margin: 0 auto;"}

| Serie                    | Hor. | $A$ | $P$ | $H$ | $\eta$  | $C$ | MAPE  | Interval Score |
|--------------------------|------|-----|-----|-----|-----|-----|-------|----------------|
|                          | 3    | `{python} resultados_1_xgb3['grilla'][resultados_1_xgb3['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0]`   | `{python} resultados_1_xgb3['grilla'][resultados_1_xgb3['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0]` | `{python} resultados_1_xgb3['grilla'][resultados_1_xgb3['grilla']['Seleccionado'] == True].head(1)['max_leaves'].values[0]` | `{python} float(resultados_1_xgb3['grilla'][resultados_1_xgb3['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_1_xgb3['grilla'][resultados_1_xgb3['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_1_xgb3['mape']*100, 4)` | `{python} round(resultados_1_xgb3['score'], 4)` |
| Atenciones    | 6    | `{python} resultados_1_xgb6['grilla'][resultados_1_xgb6['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0]`   | `{python} resultados_1_xgb6['grilla'][resultados_1_xgb6['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0]` | `{python} resultados_1_xgb6['grilla'][resultados_1_xgb6['grilla']['Seleccionado'] == True].head(1)['max_leaves'].values[0]` | `{python} float(resultados_1_xgb6['grilla'][resultados_1_xgb6['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_1_xgb6['grilla'][resultados_1_xgb6['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_1_xgb6['mape']*100, 4)` | `{python} round(resultados_1_xgb6['score'], 4)` |
|                          | 12   | `{python} resultados_1_xgb['grilla'][resultados_1_xgb['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0]`     | `{python} resultados_1_xgb['grilla'][resultados_1_xgb['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0]` | `{python} resultados_1_xgb['grilla'][resultados_1_xgb['grilla']['Seleccionado'] == True].head(1)['max_leaves'].values[0]` | `{python} float(resultados_1_xgb['grilla'][resultados_1_xgb['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_1_xgb['grilla'][resultados_1_xgb['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_1_xgb['mape']*100, 4)` | `{python} round(resultados_1_xgb['score'], 4)` |
|                          |      |                                                                                                                                 |                                                                                                                          |                                                                                                                           |                                                                                                                                     |                                                                                                                                        |                                               |                                                |
|                          | 6    | `{python} resultados_3_xgb6['grilla'][resultados_3_xgb6['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0]`   | `{python} resultados_3_xgb6['grilla'][resultados_3_xgb6['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0]` | `{python} resultados_3_xgb6['grilla'][resultados_3_xgb6['grilla']['Seleccionado'] == True].head(1)['max_leaves'].values[0]` | `{python} float(resultados_3_xgb6['grilla'][resultados_3_xgb6['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_3_xgb6['grilla'][resultados_3_xgb6['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_3_xgb6['mape']*100, 4)` | `{python} round(resultados_3_xgb6['score'], 4)` |
| Temperatura              | 12   | `{python} resultados_3_xgb12['grilla'][resultados_3_xgb12['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0]` | `{python} resultados_3_xgb12['grilla'][resultados_3_xgb12['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0]` | `{python} resultados_3_xgb12['grilla'][resultados_3_xgb12['grilla']['Seleccionado'] == True].head(1)['max_leaves'].values[0]` | `{python} float(resultados_3_xgb12['grilla'][resultados_3_xgb12['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_3_xgb12['grilla'][resultados_3_xgb12['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_3_xgb12['mape']*100, 4)` | `{python} round(resultados_3_xgb12['score'], 4)` |
|                          | 24   | `{python} resultados_3_xgb['grilla'][resultados_3_xgb['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0]`     | `{python} resultados_3_xgb['grilla'][resultados_3_xgb['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0]` | `{python} resultados_3_xgb['grilla'][resultados_3_xgb['grilla']['Seleccionado'] == True].head(1)['max_leaves'].values[0]` | `{python} float(resultados_3_xgb['grilla'][resultados_3_xgb['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_3_xgb['grilla'][resultados_3_xgb['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_3_xgb['mape']*100, 4)` | `{python} round(resultados_3_xgb['score'], 4)` |
::::

\

:::: {.tablaLetraChica}

::: {.columns}
::: {.column}

- $A$: N√∫mero de √°rboles

- $P$: Profundidad m√°xima de cada √°rbol

- $H$: N√∫mero m√°ximo de hojas de cada √°rbol

:::
::: {.column}

- $\eta$: Tasa de aprendizaje 

- $C$: Proporci√≥n de caracter√≠sticas utilizadas

:::
:::

::::

## 4.2 Aplicaci√≥n: Modelos de aprendizaje autom√°tico {.theme-slideSimple}

\

::: {.centro}
**Pron√≥sticos con XGBoost**
:::

![](../Imgs/plotnine/xgboost1.png){.img_style fig-align="center" width="80%"}

![](../Imgs/plotnine/xgboost3.png){.img_style fig-align="center" width="80%"}

## 4.2 Aplicaci√≥n: Modelos de aprendizaje autom√°tico {.theme-slideSimple}

\

::: {.centro}
**M√©tricas con LightGBM**
:::

:::{.tablaLetraChica .img_style style="background-color:white; width: auto; margin: 0 auto;"}

| Serie                    | Hor. | $A$ | $P$ | $H$ | $\eta$  | $C$ | MAPE  | Interval Score |
|--------------------------|------|-----|-----|-----|-----|-----|-------|----------------|
|                          | 3    | `{python} resultados_1_lgbm3['grilla'][resultados_1_lgbm3['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0]`   | `{python} resultados_1_lgbm3['grilla'][resultados_1_lgbm3['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0]` | `{python} resultados_1_lgbm3['grilla'][resultados_1_lgbm3['grilla']['Seleccionado'] == True].head(1)['num_leaves'].values[0]` | `{python} float(resultados_1_lgbm3['grilla'][resultados_1_lgbm3['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_1_lgbm3['grilla'][resultados_1_lgbm3['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_1_lgbm3['mape']*100, 4)` | `{python} round(resultados_1_lgbm3['score'], 4)` |
| Atenciones    | 6    | `{python} resultados_1_lgbm6['grilla'][resultados_1_lgbm6['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0]`   | `{python} resultados_1_lgbm6['grilla'][resultados_1_lgbm6['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0]` | `{python} resultados_1_lgbm6['grilla'][resultados_1_lgbm6['grilla']['Seleccionado'] == True].head(1)['num_leaves'].values[0]` | `{python} float(resultados_1_lgbm6['grilla'][resultados_1_lgbm6['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_1_lgbm6['grilla'][resultados_1_lgbm6['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_1_lgbm6['mape']*100, 4)` | `{python} round(resultados_1_lgbm6['score'], 4)` |
|                          | 12   | `{python} resultados_1_lgbm['grilla'][resultados_1_lgbm['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0]`     | `{python} resultados_1_lgbm['grilla'][resultados_1_lgbm['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0]` | `{python} resultados_1_lgbm['grilla'][resultados_1_lgbm['grilla']['Seleccionado'] == True].head(1)['num_leaves'].values[0]` | `{python} float(resultados_1_lgbm['grilla'][resultados_1_lgbm['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_1_lgbm['grilla'][resultados_1_lgbm['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_1_lgbm['mape']*100, 4)` | `{python} round(resultados_1_lgbm['score'], 4)` |
|                          |      |                                                                                                                                 |                                                                                                                          |                                                                                                                           |                                                                                                                                     |                                                                                                                                        |                                               |                                                |
|                          | 6    | `{python} int(resultados_3_lgbm6['grilla'][resultados_3_lgbm6['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0])`   | `{python} int(resultados_3_lgbm6['grilla'][resultados_3_lgbm6['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0])` | `{python} int(resultados_3_lgbm6['grilla'][resultados_3_lgbm6['grilla']['Seleccionado'] == True].head(1)['num_leaves'].values[0])` | `{python} float(resultados_3_lgbm6['grilla'][resultados_3_lgbm6['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_3_lgbm6['grilla'][resultados_3_lgbm6['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_3_lgbm6['mape']*100, 4)` | `{python} round(resultados_3_lgbm6['score'], 4)` |
| Temperatura              | 12   | `{python} int(resultados_3_lgbm12['grilla'][resultados_3_lgbm12['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0])` | `{python} int(resultados_3_lgbm12['grilla'][resultados_3_lgbm12['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0])` | `{python} int(resultados_3_lgbm12['grilla'][resultados_3_lgbm12['grilla']['Seleccionado'] == True].head(1)['num_leaves'].values[0])` | `{python} float(resultados_3_lgbm12['grilla'][resultados_3_lgbm12['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_3_lgbm12['grilla'][resultados_3_lgbm12['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_3_lgbm12['mape']*100, 4)` | `{python} round(resultados_3_lgbm12['score'], 4)` |
|                          | 24   | `{python} int(resultados_3_lgbm['grilla'][resultados_3_lgbm['grilla']['Seleccionado'] == True].head(1)['n_estimators'].values[0])`     | `{python} int(resultados_3_lgbm['grilla'][resultados_3_lgbm['grilla']['Seleccionado'] == True].head(1)['max_depth'].values[0])` | `{python} int(resultados_3_lgbm['grilla'][resultados_3_lgbm['grilla']['Seleccionado'] == True].head(1)['num_leaves'].values[0])` | `{python} float(resultados_3_lgbm['grilla'][resultados_3_lgbm['grilla']['Seleccionado'] == True].head(1)['learning_rate'].values[0])` | `{python} float(resultados_3_lgbm['grilla'][resultados_3_lgbm['grilla']['Seleccionado'] == True].head(1)['colsample_bytree'].values[0])` | `{python} round(resultados_3_lgbm['mape']*100, 4)` | `{python} round(resultados_3_lgbm['score'], 4)` |

:::

\

:::: {.tablaLetraChica}

::: {.columns}
::: {.column}

- $A$: N√∫mero de √°rboles

- $P$: Profundidad m√°xima de cada √°rbol

- $H$: N√∫mero m√°ximo de hojas de cada √°rbol

:::
::: {.column}

- $\eta$: Tasa de aprendizaje 

- $C$: Proporci√≥n de caracter√≠sticas utilizadas

:::
:::

::::

## 4.2 Aplicaci√≥n: Modelos de aprendizaje autom√°tico {.theme-slideSimple}

\


::: {.centro}
**Pron√≥sticos con LightGBM**
:::

![](../Imgs/plotnine/lgbm1.png){.img_style fig-align="center" width="80%"}

![](../Imgs/plotnine/lgbm3.png){.img_style fig-align="center" width="80%"}

## 4.3 Aplicaci√≥n: Modelos de aprendizaje profundo {.theme-slideSimple}

\

::: {.centro}
**M√©tricas con LSTM**
:::

:::{.tablaLetraChica .img_style style="background-color:white; width: auto; margin: 0 auto;"}

| Serie                    | Hor. | $N$ | $R$ | $D$ | $A$ | MAPE  | _Interval Score_ |
|--------------------------|------|--------|-----|-----|-----|-------|------------------|
|              | 3    | `{python} resultados_1_lstm3['grilla'][resultados_1_lstm3['grilla']['Seleccionado'] == True].head(1)['units'].values[0]`       | `{python} resultados_1_lstm3['grilla'][resultados_1_lstm3['grilla']['Seleccionado'] == True].head(1)['lags'].values[0]`               | `{python} resultados_1_lstm3['grilla'][resultados_1_lstm3['grilla']['Seleccionado'] == True].head(1)['dropout'].values[0]`          | `{python} resultados_1_lstm3['grilla'][resultados_1_lstm3['grilla']['Seleccionado'] == True].head(1)['activation'].values[0]`       | `{python} round(resultados_1_lstm3['mape']*100, 4)`  | `{python} round(resultados_1_lstm3['score'], 4)`  |
| Atenciones   | 6    | `{python} resultados_1_lstm6['grilla'][resultados_1_lstm6['grilla']['Seleccionado'] == True].head(1)['units'].values[0]`   | `{python} resultados_1_lstm6['grilla'][resultados_1_lstm['grilla']['Seleccionado'] == True].head(1)['lags'].values[0]`    | `{python} resultados_1_lstm6['grilla'][resultados_1_lstm6['grilla']['Seleccionado'] == True].head(1)['dropout'].values[0]`   | `{python} resultados_1_lstm6['grilla'][resultados_1_lstm6['grilla']['Seleccionado'] == True].head(1)['activation'].values[0]`   | `{python} round(resultados_1_lstm6['mape']*100, 4)`  | `{python} round(resultados_1_lstm6['score'], 4)`  |
|              | 12   | `{python} resultados_1_lstm['grilla'][resultados_1_lstm['grilla']['Seleccionado'] == True].head(1)['units'].values[0]`     | `{python} resultados_1_lstm['grilla'][resultados_1_lstm['grilla']['Seleccionado'] == True].head(1)['lags'].values[0]`     | `{python} resultados_1_lstm['grilla'][resultados_1_lstm['grilla']['Seleccionado'] == True].head(1)['dropout'].values[0]`     | `{python} resultados_1_lstm['grilla'][resultados_1_lstm['grilla']['Seleccionado'] == True].head(1)['activation'].values[0]`     | `{python} round(resultados_1_lstm['mape']*100, 4)`   | `{python} round(resultados_1_lstm['score'], 4)`   |
|              |      |                                                                                                                                |                                                                                                                                       |                                                                                                                                     |                                                                                                                                     |                                                  |                                                   |
|              | 6    | `{python} resultados_3_lstm6['grilla'][resultados_3_lstm6['grilla']['Seleccionado'] == True].head(1)['units'].values[0]`   | `{python} resultados_3_lstm6['grilla'][resultados_3_lstm6['grilla']['Seleccionado'] == True].head(1)['lags'].values[0]`   | `{python} resultados_3_lstm6['grilla'][resultados_3_lstm6['grilla']['Seleccionado'] == True].head(1)['dropout'].values[0]`   | `{python} resultados_3_lstm6['grilla'][resultados_3_lstm6['grilla']['Seleccionado'] == True].head(1)['activation'].values[0]`   | `{python} round(resultados_3_lstm6['mape']*100, 4)`  | `{python} round(resultados_3_lstm6['score'], 4)`  |
| Temperatura  | 12   | `{python} resultados_3_lstm12['grilla'][resultados_3_lstm12['grilla']['Seleccionado'] == True].head(1)['units'].values[0]` | `{python} resultados_3_lstm12['grilla'][resultados_3_lstm12['grilla']['Seleccionado'] == True].head(1)['lags'].values[0]` | `{python} resultados_3_lstm12['grilla'][resultados_3_lstm12['grilla']['Seleccionado'] == True].head(1)['dropout'].values[0]` | `{python} resultados_3_lstm12['grilla'][resultados_3_lstm12['grilla']['Seleccionado'] == True].head(1)['activation'].values[0]` | `{python} round(resultados_3_lstm12['mape']*100, 4)` | `{python} round(resultados_3_lstm12['score'], 4)` |
|              | 24   | `{python} resultados_3_lstm['grilla'][resultados_3_lstm['grilla']['Seleccionado'] == True].head(1)['units'].values[0]`     | `{python} resultados_3_lstm['grilla'][resultados_3_lstm['grilla']['Seleccionado'] == True].head(1)['lags'].values[0]`     | `{python} resultados_3_lstm['grilla'][resultados_3_lstm['grilla']['Seleccionado'] == True].head(1)['dropout'].values[0]`     | `{python} resultados_3_lstm['grilla'][resultados_3_lstm['grilla']['Seleccionado'] == True].head(1)['activation'].values[0]`     | `{python} round(resultados_3_lstm['mape']*100, 4)`   | `{python} round(resultados_3_lstm['score'], 4)`   |

:::

\

:::: {.tablaLetraChica}

300 iteraciones de entrenamiento con $\eta$ = 0.001 y paciencia = 10.

::: {.columns}
::: {.column}

- $N$: Capas y neuronas en el modelo

- $R$: Rezagos con los que se entrena el modelo

:::
::: {.column}

- $D$: Proporci√≥n de *dropout* en cada capa

- $A$: Funci√≥n de activaci√≥n

:::
:::

::::

## 4.3 Aplicaci√≥n: Modelos de aprendizaje profundo {.theme-slideSimple}

\


::: {.centro}
**Pron√≥sticos con LSTM**
:::

![](../Imgs/plotnine/lstm1.png){.img_style fig-align="center" width="80%"}

![](../Imgs/plotnine/lstm3.png){.img_style fig-align="center" width="80%"}

# 5. Comparaci√≥n de resultados {.center .theme-slideTitle}

## 5.1 Comparaci√≥n de resultados: Serie 1 {.theme-slideSimple}

\

::: {.centro}
**Atenciones en guardia por patolog√≠as respiratorias**
:::

![](../Imgs/tabla_resumen_1.png){.img_style fig-align="center" width="80%"}

## 5.1 Comparaci√≥n de resultados: Serie 1 {.theme-slideSimple}

\

::: {.centro}
**Atenciones en guardia por patolog√≠as respiratorias**
:::

![](../Imgs/plotnine/comparativaAtenciones.png){.img_style fig-align="center"}


## 5.2 Comparaci√≥n de resultados: Serie 2 {.theme-slideSimple}

\

::: {.centro}
**Temperatura (C¬∫) por hora en los primeros d√≠as de marzo 2025**
:::

![](../Imgs/tabla_resumen_3.png){.img_style fig-align="center" width="80%"}

## 5.2 Comparaci√≥n de resultados: Serie 2 {.theme-slideSimple}

\

::: {.centro}
**Temperatura (C¬∫) por hora en los primeros d√≠as de marzo 2025**
:::

![](../Imgs/plotnine/comparativaTemperaturas.png){.img_style fig-align="center"}

# 6. Conclusi√≥n y comentarios finales {.center .theme-slideTitle}

# ¬°MUCHAS GRACIAS! üòÄ {.center}